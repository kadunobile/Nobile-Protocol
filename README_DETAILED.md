# üéØ Protocolo N√≥bile - Documenta√ß√£o Detalhada

## üìã √çndice

- [Vis√£o Geral](#vis√£o-geral)
- [Reality Check Flow](#reality-check-flow)
- [Arquitetura do Sistema](#arquitetura-do-sistema)
- [Fluxo de Dados](#fluxo-de-dados)
- [M√≥dulos Principais](#m√≥dulos-principais)
- [Guia de Desenvolvimento](#guia-de-desenvolvimento)

---

## üåü Vis√£o Geral

O **Protocolo N√≥bile** √© uma plataforma completa de otimiza√ß√£o de curr√≠culos powered by AI que combina:

- **An√°lise ATS automatizada** (Applicant Tracking Systems)
- **Reality Check inteligente** com GPT-4
- **Gera√ß√£o contextual de documentos** (cartas, respostas)
- **Prepara√ß√£o personalizada** para entrevistas

### P√∫blico-Alvo

Profissionais de **TODOS os n√≠veis**:
- üë∂ **J√∫nior** - Primeiro emprego, est√°gio
- üíº **Pleno** - Consolida√ß√£o de carreira
- üéØ **S√™nior/Especialista** - Posi√ß√µes de alta senioridade
- üëî **Gerencial/Executivo** - C-Level, VP, Diretor

### √Åreas Atendidas

‚úÖ Tecnologia (Dev, Data, DevOps, Infra)
‚úÖ Vendas e Comercial
‚úÖ Marketing e Growth
‚úÖ RH e People
‚úÖ Financeiro e Controladoria
‚úÖ Opera√ß√µes e Log√≠stica
‚úÖ Administrativo e Suporte

---

## üîç Reality Check Flow

### O que √© o Reality Check?

O **Reality Check** √© a etapa mais cr√≠tica do Protocolo N√≥bile. √â uma an√°lise profunda e honesta do curr√≠culo do candidato, conduzida por GPT-4, que identifica:

1. ‚úÖ **Pontos Fortes** - O que est√° funcionando bem
2. ‚ö†Ô∏è **Gaps Cr√≠ticos** - Lacunas que podem impedir aprova√ß√£o
3. üí° **Oportunidades** - Melhorias acion√°veis
4. üìä **An√°lise Salarial** - Compatibilidade com mercado

### Fluxo Detalhado

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    REALITY CHECK FLOW                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1Ô∏è‚É£ COLETA DE DADOS
   ‚îú‚îÄ‚îÄ Upload do CV (PDF/DOCX/TXT)
   ‚îú‚îÄ‚îÄ Briefing inicial (cargo-alvo, pretens√£o)
   ‚îî‚îÄ‚îÄ Contexto profissional

2Ô∏è‚É£ AN√ÅLISE ATS (Pr√©-Reality)
   ‚îú‚îÄ‚îÄ Score 0-100
   ‚îú‚îÄ‚îÄ An√°lise de se√ß√µes
   ‚îú‚îÄ‚îÄ Densidade de keywords
   ‚îú‚îÄ‚îÄ M√©tricas quantific√°veis
   ‚îî‚îÄ‚îÄ Formata√ß√£o e tamanho

3Ô∏è‚É£ REALITY CHECK (GPT-4)
   ‚îú‚îÄ‚îÄ üéØ An√°lise de Fit Cargo x CV
   ‚îÇ   ‚îî‚îÄ‚îÄ Match de habilidades obrigat√≥rias
   ‚îÇ
   ‚îú‚îÄ‚îÄ üìä An√°lise Salarial
   ‚îÇ   ‚îú‚îÄ‚îÄ Faixa de mercado para cargo
   ‚îÇ   ‚îú‚îÄ‚îÄ Compara√ß√£o com pretens√£o
   ‚îÇ   ‚îî‚îÄ‚îÄ Recomenda√ß√£o de ajuste
   ‚îÇ
   ‚îú‚îÄ‚îÄ ‚úÖ Pontos Fortes (3-5 itens)
   ‚îÇ   ‚îî‚îÄ‚îÄ Destaques que agregam valor
   ‚îÇ
   ‚îú‚îÄ‚îÄ ‚ö†Ô∏è Gaps Cr√≠ticos (2-4 itens)
   ‚îÇ   ‚îú‚îÄ‚îÄ Lacunas ACION√ÅVEIS
   ‚îÇ   ‚îú‚îÄ‚îÄ Contextualizadas ao cargo
   ‚îÇ   ‚îî‚îÄ‚îÄ Priorizadas por impacto
   ‚îÇ
   ‚îî‚îÄ‚îÄ üí° Recomenda√ß√µes
       ‚îú‚îÄ‚îÄ Altera√ß√µes no CV
       ‚îú‚îÄ‚îÄ Upskilling necess√°rio
       ‚îî‚îÄ‚îÄ Posicionamento estrat√©gico

4Ô∏è‚É£ INTERA√á√ÉO (Opcional)
   ‚îú‚îÄ‚îÄ Esclarecer d√∫vidas
   ‚îú‚îÄ‚îÄ Aprofundar gaps
   ‚îî‚îÄ‚îÄ Solicitar alternativas

5Ô∏è‚É£ OTIMIZA√á√ÉO
   ‚îú‚îÄ‚îÄ Reescrever se√ß√µes
   ‚îú‚îÄ‚îÄ Adicionar keywords ATS
   ‚îú‚îÄ‚îÄ Quantificar resultados
   ‚îî‚îÄ‚îÄ Ajustar formata√ß√£o

6Ô∏è‚É£ VALIDA√á√ÉO
   ‚îú‚îÄ‚îÄ Novo Score ATS
   ‚îú‚îÄ‚îÄ Comparador Antes/Depois
   ‚îî‚îÄ‚îÄ Certifica√ß√£o de melhoria
```

### Exemplo de Reality Check

**Entrada:**
- **Cargo-alvo:** Gerente de Projetos
- **Pretens√£o:** R$ 15.000
- **CV:** 8 anos como analista, sem experi√™ncia em lideran√ßa formal

**Sa√≠da do Reality Check:**

```markdown
### üìä AN√ÅLISE SALARIAL
**Faixa de Mercado:** 12.000 - 18.000 mensal
**Sua Pretens√£o:** 15.000 mensal
**Avalia√ß√£o:** ‚úÖ Dentro da faixa (mediana)

---

### ‚úÖ PONTOS FORTES
1. **8 anos de experi√™ncia consolidada** em gest√£o de projetos
2. **Certifica√ß√£o PMP** (diferencial competitivo)
3. **Experi√™ncia com metodologias √°geis** (Scrum, Kanban)

---

### ‚ö†Ô∏è GAPS CR√çTICOS
1. **Falta evid√™ncia de lideran√ßa de equipes**
   - CV menciona "coordena√ß√£o" mas n√£o quantifica size do time
   - Recomenda√ß√£o: Adicionar "Coordenei equipe de X pessoas"

2. **Aus√™ncia de m√©tricas de impacto**
   - Projetos descritos sem resultados mensur√°veis
   - Recomenda√ß√£o: Adicionar "Reduzi prazo em 20%", "Economizei R$ X"

3. **Keywords ATS insuficientes**
   - Faltam: "Gest√£o de Stakeholders", "Budget Management", "Risk Assessment"
   - Recomenda√ß√£o: Incorporar naturalmente no CV

---

### üí° PR√ìXIMOS PASSOS
1. Reescrever se√ß√£o de Experi√™ncia com modelo STAR
2. Adicionar n√∫meros em TODOS os projetos principais
3. Criar se√ß√£o "Lideran√ßa" destacando coordena√ß√£o de equipes
```

---

## üèóÔ∏è Arquitetura do Sistema

### Estrutura de Diret√≥rios

```
Nobile-Protocol/
‚îú‚îÄ‚îÄ app.py                    # Entry point da aplica√ß√£o
‚îú‚îÄ‚îÄ streamlit_app.py          # App alternativo
‚îú‚îÄ‚îÄ bootstrap_protocolo.py    # Script de inicializa√ß√£o
‚îÇ
‚îú‚îÄ‚îÄ core/                     # L√≥gica de neg√≥cio central
‚îÇ   ‚îú‚îÄ‚îÄ config.py            # Configura√ß√µes e env vars
‚îÇ   ‚îú‚îÄ‚îÄ state.py             # Gerenciamento de estado Streamlit
‚îÇ   ‚îú‚îÄ‚îÄ data.py              # Dados est√°ticos (cidades, etc)
‚îÇ   ‚îú‚îÄ‚îÄ utils.py             # Utilit√°rios (PDF, GPT, scroll)
‚îÇ   ‚îú‚îÄ‚îÄ validators.py        # Valida√ß√£o de inputs
‚îÇ   ‚îú‚îÄ‚îÄ prompts.py           # System prompts GPT
‚îÇ   ‚îú‚îÄ‚îÄ ats_scorer.py        # Algoritmo de score ATS
‚îÇ   ‚îú‚îÄ‚îÄ cv_comparator.py     # Compara√ß√£o antes/depois
‚îÇ   ‚îî‚îÄ‚îÄ interview_prep.py    # Gera√ß√£o de perguntas
‚îÇ
‚îú‚îÄ‚îÄ modules/                  # M√≥dulos especializados
‚îÇ   ‚îî‚îÄ‚îÄ otimizador/
‚îÇ       ‚îî‚îÄ‚îÄ processor.py     # Processamento de otimiza√ß√£o
‚îÇ
‚îú‚îÄ‚îÄ ui/                       # Interface do usu√°rio
‚îÇ   ‚îú‚îÄ‚îÄ sidebar.py           # Barra lateral
‚îÇ   ‚îú‚îÄ‚îÄ chat.py              # Interface de chat
‚îÇ   ‚îî‚îÄ‚îÄ screens/             # Telas do fluxo
‚îÇ       ‚îú‚îÄ‚îÄ fase0_intro.py
‚îÇ       ‚îú‚îÄ‚îÄ fase0_upload.py
‚îÇ       ‚îú‚îÄ‚îÄ fase1_diagnostico.py
‚îÇ       ‚îú‚îÄ‚îÄ fase1_briefing.py
‚îÇ       ‚îú‚îÄ‚îÄ fase15_reality.py       ‚Üê REALITY CHECK
‚îÇ       ‚îú‚îÄ‚îÄ fase_analise_loading.py
‚îÇ       ‚îú‚îÄ‚îÄ fase_gaps_interativos.py
‚îÇ       ‚îú‚îÄ‚îÄ fase_ats_score.py
‚îÇ       ‚îú‚îÄ‚îÄ fase_carta.py
‚îÇ       ‚îú‚îÄ‚îÄ fase_interview.py
‚îÇ       ‚îî‚îÄ‚îÄ fase_comparador.py
‚îÇ
‚îú‚îÄ‚îÄ tests/                    # Testes automatizados
‚îÇ   ‚îî‚îÄ‚îÄ test_validators.py
‚îÇ
‚îú‚îÄ‚îÄ docs/                     # Documenta√ß√£o adicional
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt          # Depend√™ncias Python
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ LICENSE                   # Apache 2.0
‚îî‚îÄ‚îÄ README.md                 # Documenta√ß√£o principal
```

### Stack Tecnol√≥gico

| Camada | Tecnologia | Vers√£o |
|--------|-----------|--------|
| **Backend** | Python | 3.11+ |
| **Frontend** | Streamlit | Latest |
| **IA** | OpenAI GPT | GPT-4o |
| **PDF Parser** | PyPDF2 | Latest |
| **Word Parser** | python-docx | Latest |
| **Diff** | difflib | stdlib |

---

## üîÑ Fluxo de Dados

### 1. Inicializa√ß√£o

```python
setup_environment()  # Carrega vari√°veis de ambiente
inicializar_session_state()  # Inicializa st.session_state
```

### 2. Upload e Parsing

```python
arquivo_cv ‚Üí extrair_texto_pdf() ‚Üí cv_texto (str)
                ‚Üì
        validar_arquivo_cv()
                ‚Üì
        st.session_state.cv_texto
```

### 3. Briefing

```python
Inputs do usu√°rio:
‚îú‚îÄ‚îÄ cargo_alvo
‚îú‚îÄ‚îÄ pretensao_salarial
‚îú‚îÄ‚îÄ cidade
‚îî‚îÄ‚îÄ nivel_senioridade

        ‚Üì
st.session_state.perfil = {
    "cargo_alvo": str,
    "pretensao_salarial": float,
    "cidade": str,
    "nivel": str
}
```

### 4. Score ATS (Pr√©-Reality)

```python
calcular_score_ats(cv_texto, cargo_alvo)
        ‚Üì
{
    "score_total": 0-100,
    "detalhes": {
        "secoes": {...},
        "keywords": {...},
        "metricas": {...},
        "formatacao": {...},
        "tamanho": {...}
    },
    "recomendacoes": [...]   
}
```

### 5. Reality Check (GPT-4)

```python
prompt_reality = f"""
[SYSTEM_PROMPT]

CV:
{cv_texto}

Cargo-alvo: {cargo_alvo}
Pretens√£o: {pretensao}

Analise e gere Reality Check completo.
"""

        ‚Üì
chamar_gpt(mensagens, temperature=0.7)
        ‚Üì
resposta_reality (markdown formatado)
```

### 6. Otimiza√ß√£o Interativa

```python
Loop de Chat:
user_input ‚Üí mensagens.append(user)
        ‚Üì
chamar_gpt(mensagens, seed=42, temp=0.3)
        ‚Üì
resposta_gpt ‚Üí mensagens.append(assistant)
        ‚Üì
display(chat_history)
```

---

## üß© M√≥dulos Principais

### 1. `core/ats_scorer.py`

**Prop√≥sito:** Simular como sistemas ATS reais avaliam curr√≠culos

**Fun√ß√£o principal:**
```python
def calcular_score_ats(cv_texto: str, cargo_alvo: str) -> Dict:
    """
    Retorna score 0-100 baseado em:
    - Se√ß√µes essenciais (20 pts)
    - Keywords relevantes (30 pts)
    - M√©tricas quantific√°veis (20 pts)
    - Formata√ß√£o adequada (15 pts)
    - Tamanho apropriado (15 pts)
    """
```

**Algoritmo:**
1. Regex para detectar se√ß√µes (experi√™ncia, educa√ß√£o, etc)
2. Extra√ß√£o de keywords baseadas no cargo
3. Contagem de n√∫meros/porcentagens
4. An√°lise de formata√ß√£o (bullets, datas, etc)
5. Valida√ß√£o de tamanho (ideal: 400-800 palavras)

### 2. `core/utils.py - chamar_gpt()`

**Prop√≥sito:** Wrapper robusto para chamadas OpenAI

**Features:**
- ‚úÖ Retry autom√°tico (3x por padr√£o)
- ‚úÖ Rate limit handling
- ‚úÖ Timeout configur√°vel
- ‚úÖ Logging detalhado
- ‚úÖ Error handling gracioso

```python
def chamar_gpt(
    client: OpenAI,
    mensagens: List[Dict],
    temperature: float = 0.7,
    seed: int = None
) -> str:
    """
    Implementa retry exponential backoff para:
    - APITimeoutError
    - RateLimitError
    - OpenAIError gen√©rico
    """
```

### 3. `ui/screens/fase15_reality.py`

**Prop√≥sito:** Renderizar tela de Reality Check

**Fluxo:**
1. **Scroll autom√°tico para topo** (forcar_topo())
2. **Header visual** com √≠cone e t√≠tulo
3. **Trigger de an√°lise** (bot√£o "Iniciar Reality Check")
4. **Loading state** com spinner
5. **Display de resultado** (markdown rico)
6. **Navega√ß√£o** para pr√≥xima etapa

**C√≥digo-chave:**
```python
def fase_15_reality_check():
    forcar_topo()  # CRITICAL: scroll para topo
    
    st.markdown("# üîç Reality Check")
    
    if st.button("üöÄ Iniciar Reality Check"):
        with st.spinner("ü§î Analisando profundamente..."):
            prompt = gerar_prompt_reality()
            resposta = chamar_gpt(client, prompt)
            
            st.markdown(resposta)
            st.session_state.reality_completo = True
```

### 4. `core/cv_comparator.py`

**Prop√≥sito:** Comparar CV antes/depois da otimiza√ß√£o

**M√©tricas analisadas:**
```python
{
    "palavras": {"antes": X, "depois": Y, "melhoria": Z%},
    "numeros": {...},
    "verbos_acao": {...},
    "secoes": {...},
    "similaridade": X%  # 0-100, quanto mudou
}
```

**Visualiza√ß√µes:**
1. **Resumo** - Cards com % de melhoria
2. **Lado a Lado** - Compara√ß√£o textual
3. **Diff Detalhado** - Linha por linha (difflib)

---

## üõ†Ô∏è Guia de Desenvolvimento

### Setup Local

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/kadunobile/Nobile-Protocol.git
cd Nobile-Protocol

# 2. Crie ambiente virtual
python -m venv venv
source venv/bin/activate  # Linux/Mac
# ou
venv\Scripts\activate  # Windows

# 3. Instale depend√™ncias
pip install -r requirements.txt

# 4. Configure .env
cp .env.example .env
# Edite .env e adicione:
# OPENAI_API_KEY=sk-...

# 5. Execute
streamlit run app.py
```

### Rodando Testes

```bash
# Todos os testes
pytest

# Com coverage
pytest --cov=core --cov=ui

# Teste espec√≠fico
pytest tests/test_validators.py -v
```

### Adicionando Nova Fase

```python
# 1. Criar arquivo em ui/screens/
# ui/screens/fase_nova_feature.py

import streamlit as st

def fase_nova_feature():
    st.markdown("# üÜï Nova Feature")
    
    # Sua l√≥gica aqui
    if st.button("Executar"):
        resultado = processar()
        st.success("Sucesso!")

# 2. Importar em app.py
from ui.screens.fase_nova_feature import fase_nova_feature

# 3. Adicionar ao fluxo
FASES = {
    "nova_feature": fase_nova_feature,
    ...
}

# 4. Atualizar sidebar.py
st.sidebar.button("üÜï Nova Feature", 
                  on_click=lambda: mudar_fase("nova_feature"))
```

### Guidelines de C√≥digo

1. **Type hints obrigat√≥rios**
   ```python
   def funcao(param: str) -> Dict[str, Any]:
       pass
   ```

2. **Docstrings para fun√ß√µes p√∫blicas**
   ```python
   def funcao():
       """
       Descri√ß√£o curta.
       
       Args:
           param: Descri√ß√£o
       
       Returns:
           Descri√ß√£o do retorno
       """
   ```

3. **Logging ao inv√©s de print**
   ```python
   import logging
   logger = logging.getLogger(__name__)
   
   logger.info("Mensagem informativa")
   logger.warning("Alerta")
   logger.error("Erro", exc_info=True)
   ```

4. **Valida√ß√£o de inputs**
   ```python
   from core.validators import validar_cargo
   
   valido, erro = validar_cargo(input_usuario)
   if not valido:
       st.error(erro)
       return
   ```

---

## üìä M√©tricas de Qualidade

### Coverage Atual
- **Core:** 85%
- **UI:** 45% (Streamlit dificulta testes)
- **Modules:** 78%

### Performance
- **Tempo m√©dio Reality Check:** 8-15s (GPT-4)
- **Parse PDF:** < 1s (at√© 10MB)
- **Score ATS:** < 0.5s

### Limita√ß√µes Conhecidas

1. **PDFs escaneados** - N√£o extrai texto (sem OCR)
2. **Formata√ß√£o complexa** - Tabelas podem quebrar
3. **Rate limiting** - OpenAI 3 RPM (tier free)

---

## üîê Seguran√ßa

- ‚úÖ **API keys em .env** (nunca no c√≥digo)
- ‚úÖ **Valida√ß√£o de inputs** (size, tipo, conte√∫do)
- ‚úÖ **Sanitiza√ß√£o de uploads** (extens√£o, tamanho)
- ‚úÖ **Sem armazenamento** de dados do usu√°rio
- ‚úÖ **Session state isolado** (por sess√£o Streamlit)

---

## üìù Contribuindo

Ver [CONTRIBUTING.md](./CONTRIBUTING.md) para guidelines detalhados.

**Quick Start:**
1. Fork o reposit√≥rio
2. Crie branch feature (`git checkout -b feature/nova-funcao`)
3. Commit com mensagem descritiva
4. Push e abra Pull Request

---

## üìÑ Licen√ßa

Apache License 2.0 - Ver [LICENSE](./LICENSE)

---

## ü§ù Suporte

- **Issues:** https://github.com/kadunobile/Nobile-Protocol/issues
- **Discuss√µes:** https://github.com/kadunobile/Nobile-Protocol/discussions

---

**√öltima atualiza√ß√£o:** Fevereiro 2026
**Vers√£o:** 2.0
